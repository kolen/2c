//******************************************************************************************
//Начальная инициализация модуля - процедура вызывается в режиме Конфигуратора и Предприятия
//******************************************************************************************
Перем ФлагОтменыСобытияЗапись;
//------------------------------------------------------------------------------------------
Процедура ИнициализацияМодуля()

КонецПроцедуры

Процедура ПриНачалеРаботыСистемы()
	ПодписатьсяНаСобытие("ПослеЗаписиСправочника","ОбработкаСобытияПослеЗаписиСправочника");
	ПодписатьсяНаСобытие("ПослеУдаленияСправочника","ОбработкаСобытияПослеУдаленияСправочника");
	ПодписатьсяНаСобытие("ПослеПроведения","ОбработкаСобытияПослеПроведения");
	ПодписатьсяНаСобытие("ПослеОтменыПроведения","ОбработкаСобытияПослеОтменыПроведения");
КонецПроцедуры//ПриНачалеРаботыСистемы()

Процедура ПриЗавершенииРаботыСистемы()
	ЖурналСоб=СоздатьОбъект("ЖурналСобытий");
	ЖурналСоб.ЗаписатьСобытие(2,"Отключение");
КонецПроцедуры//ПриЗавершенииРаботыСистемы

//___________________________________________________________________________________________
Функция ОбработкаСобытияПослеЗаписиСправочника(ФлагЗапрета,Объект)
	Если ФлагОтменыСобытияЗапись Тогда
		ФлагОтменыСобытияЗапись=0;
		Возврат 0;
	КонецЕсли
	ЖурналСоб=СоздатьОбъект("ЖурналСобытий");
	ЖурналСоб.ЗаписатьСобытие(2,"Запись объекта",Объект);
	Возврат 0;
КонецФункции//ОбработкаСобытияПослеЗаписиСправочника
//___________________________________________________________________________________________
Функция ОбработкаСобытияПослеУдаленияСправочника(ФлагЗапрета,Объект)
	ЖурналСоб=СоздатьОбъект("ЖурналСобытий");
	ЖурналСоб.ЗаписатьСобытие(2,"Удаление объекта",Объект);
	ФлагОтменыСобытияЗапись=1;
	Возврат 0;
КонецФункции//ОбработкаСобытияПослеУдаленияСправочника
//___________________________________________________________________________________________
Функция ОбработкаСобытияПослеПроведения(ФлагЗапрета,Объект)
	ЖурналСоб=СоздатьОбъект("ЖурналСобытий");
	ЖурналСоб.ЗаписатьСобытие(2,"Проведение объекта",Объект);
	ФлагОтменыСобытияЗапись=1;
	Возврат 0;
КонецФункции//ОбработкаСобытияПослеПроведения
//___________________________________________________________________________________________
Функция ОбработкаСобытияПослеОтменыПроведения(ФлагЗапрета,Объект)
	ЖурналСоб=СоздатьОбъект("ЖурналСобытий");
	ЖурналСоб.ЗаписатьСобытие(2,"Отмена проведения объекта",Объект);
	ФлагОтменыСобытияЗапись=1;
	Возврат 0;
КонецФункции//ОбработкаСобытияПослеОтменыПроведения