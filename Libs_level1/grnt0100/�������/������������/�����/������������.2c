//Автор:  Alex_Bob 
//E-mail: asbobylk@svsokol.lipetsk.ru
//Версия модуля: 1.00 от 29.06.2004
//Релиз платформы: позже 09.06.2004

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Перем ИД;
Процедура ПриОткрытии()
    Конт=Форма.Параметр;
    Если ТипЗначенияСтр(Конт)="СписокЗначений"  Тогда
        ИД=Конт.ПолучитьЗначение(1);
        Имя=Конт.ПолучитьЗначение(2);
        НаборПрав=0;
        Если Конт.РазмерСписка()>2 Тогда
        	
        	ПолноеИмя=Конт.ПолучитьЗначение(3);
        	НаборПрав=Конт.ПолучитьЗначение(4);
        	ДомашнийКаталог=Конт.ПолучитьЗначение(5);
        	Интерфейс=Конт.ПолучитьЗначение(6);
        КонецЕсли;
        НП=СоздатьОбъект("НаборыПрав");
        НП.ВыбратьЭлементы();
        Пока НП.ПолучитьЭлемент()=1 Цикл
        	СпНаборПрав.ДобавитьЗначение(НП.ИД,НП.Имя); 
        КонецЦикла;
        Если Конт.РазмерСписка()>2 Тогда
            СпНаборПрав.ТекущаяСтрока(СпНаборПрав.НайтиЗначение(НаборПрав));
        Иначе
            СпНаборПрав.ТекущаяСтрока(1);
        КонецЕсли
        Инт=СоздатьОбъект("Интерфейсы");
        Инт.ВыбратьЭлементы();
        Пока Инт.ПолучитьЭлемент()=1 Цикл
        	СпИнтерфейс.ДобавитьЗначение(Инт.ИД,Инт.Имя); 
        КонецЦикла
        Если Конт.РазмерСписка()>5 Тогда
            СпИнтерфейс.ТекущаяСтрока(СпИнтерфейс.НайтиЗначение(Интерфейс));
        Иначе
            СпИнтерфейс.ТекущаяСтрока(1);
        КонецЕсли
    Иначе
        Форма.Закрыть(0);	 
    КонецЕсли
    
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()
    Сп=СоздатьОбъект("СписокЗначений");
    Сп.ДобавитьЗначение(ИД);
    Сп.ДобавитьЗначение(Имя);
    Сп.ДобавитьЗначение(ПолноеИмя);
    Сп.ДобавитьЗначение(СпНаборПрав.ПолучитьЗначение(СпНаборПрав.ТекущаяСтрока()));
    Сп.ДобавитьЗначение(ДомашнийКаталог);
    Сп.ДобавитьЗначение(СпИнтерфейс.ПолучитьЗначение(СпИнтерфейс.ТекущаяСтрока()));
    ЗначениеВФайл(КаталогВременныхФайлов()+"lst.txt",Сп);
//	Если СостояниеКлавиши(27) Тогда
//		СтатусВозврата(0);
//	КонецЕсли;
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

//---------------------------------------------------------------------
Процедура ПриВыбореДомашнегоКаталога()
	ТекПуть=ДомашнийКаталог;
	ФС=СоздатьОбъект("Файловая система");
    Если ФС.ВыбратьКаталог(ТекПуть)=1 Тогда
        ДомашнийКаталог=ТекПуть;
    КонецЕсли;   
КонецПроцедуры//ПриВыбореДомашнегоКаталога
