//Автор:  Alex_Bob 
//E-mail: asbobylk@svsokol.lipetsk.ru
//Версия модуля: 1.00 от 29.06.2004
//Релиз платформы: позже 09.06.2004

Перем ЗапросБД Экспорт;
Перем ИмяТаблицы  Экспорт;
Перем МассивРеквизитов Экспорт;
Перем МассивИмен Экспорт;
Перем СоответствияПолей Экспорт;
Перем БылаИнициализация Экспорт;

//******************************************************************************************
//Предопределенные процедуры и функции в режиме Предприятия
//******************************************************************************************

Процедура ПриНачалеРаботыСистемы()
	
	Пользователь=СоздатьОбъект("Пользователи");
	Если Пользователь.КоличествоЭлементов()=0 Тогда
	    Пользователь.Новый();
	    Пользователь.ИД=0x100000000*Пользователь.НомерТаблицыОбъекта()+1;
	    Пользователь.Имя="admin";
        Пользователь.ПолноеИмя="Администратор";
        Пользователь.Пароль=GetHash("admin");
        НаборПрав=СоздатьОбъект("НаборыПрав");
        Если НаборПрав.КоличествоЭлементов()>0 Тогда
        	НаборПрав.ВыбратьЭлементы();
        	НаборПрав.ПолучитьЭлемент();
        	
        Иначе
	        НаборПрав.Новый();
	        НаборПрав.ИД=0x100000000*НаборПрав.НомерТаблицыОбъекта()+1;
	        НаборПрав.Имя="Администратор"; 
    		НаборПрав.Записать();	 
        КонецЕсли
        Пользователь.НаборПрав=НаборПрав.ИД;
        Интерфейс=СоздатьОбъект("Интерфейсы");
        Если Интерфейс.КоличествоЭлементов()>0 Тогда
        	Интерфейс.ВыбратьЭлементы();
        	Интерфейс.ПолучитьЭлемент();
        Иначе
	        Интерфейс.Новый();
	    	Интерфейс.ИД=0x100000000*Интерфейс.НомерТаблицыОбъекта()+1;;
	    	Интерфейс.Имя="Администратор";
        	Интерфейс.Записать();	
        КонецЕсли
        Пользователь.Интерфейс=Интерфейс.ИД; 
        Пользователь.Записать();
    КонецЕсли;    
КонецПроцедуры

Процедура ПриЗавершенииРаботыСистемы()

КонецПроцедуры 

Процедура НачальнаяИнициализация()Экспорт
	БылаИнициализация=1;

	ИмяТаблицы="users";

	ТаблицаБД=СоздатьОбъект("ТаблицаБД");
	ТаблицаБД.УстановитьИмяИдентификатора("ИД");
	ТаблицаБД.ДобавитьПоле("ИД","Число",20,0);
	ТаблицаБД.ДобавитьПоле("Имя","Строка",50,0);
	ТаблицаБД.ДобавитьПоле("ПолноеИмя","Строка",50,0);
	ТаблицаБД.ДобавитьПоле("Пароль","Строка",50,0);
	ТаблицаБД.ДобавитьПоле("ДомашнийКаталог","Строка",200,0);
	ТаблицаБД.ДобавитьПоле("НаборПрав","Число",20,0);
	ТаблицаБД.ДобавитьПоле("Интерфейс","Число",20,0);	
	ТаблицаБД.НачальнаяИнициализация("Пользователи",ИмяТаблицы,2,0);
	
КонецПроцедуры

//******************************************************************************************
//Предопределенные процедуры и функции в режиме Конфигуратора
//******************************************************************************************
Процедура ПриНачалеРаботыКонфигуратора()

КонецПроцедуры 


Процедура ПриЗавершенииРаботыКонфигуратора()

КонецПроцедуры 


