//Автор:  Alex_Bob 
//E-mail: asbobylk@svsokol.lipetsk.ru
//Версия модуля: 1.00 от 29.06.2004
//Релиз платформы: позже 09.06.2004

Перем ЗапросБД Экспорт;
Перем ИмяТаблицы  Экспорт;
Перем МассивРеквизитов Экспорт;
Перем МассивИмен Экспорт;
Перем СоответствияПолей Экспорт;
Перем БылаИнициализация Экспорт;

//******************************************************************************************
//Предопределенные процедуры и функции в режиме Предприятия
//******************************************************************************************

Процедура ПриНачалеРаботыСистемы()

	Права=СоздатьОбъект("ПраваДоступа");
	Если Права.КоличествоЭлементов()=0 Тогда
	    
	    НаборПрав=СоздатьОбъект("НаборыПрав");
        Если НаборПрав.КоличествоЭлементов()>0 Тогда
        	НаборПрав.ВыбратьЭлементы();
        	НаборПрав.ПолучитьЭлемент();
        	АдмНаборПрав=НаборПрав.ИД; 
        КонецЕсли;
        Права.Новый();
        Права.ИД=0x100000000*Права.НомерТаблицыОбъекта()+1;
        Права.НаборПрав=АдмНаборПрав;
        Права.ТипПрава="all"
        Права.Записать();
   	   	Сп=СоздатьОбъект("СписокЗначений");
   	   	Сп.ДобавитьЗначение("admin",GetHash("admin"));  
   	    ЗначениеВФайл(КаталогИБ()+"USERS\"+АдмНаборПрав+".usr",Сп);
    КонецЕсли;    
КонецПроцедуры

Процедура ПриЗавершенииРаботыСистемы()

КонецПроцедуры 

Процедура НачальнаяИнициализация()Экспорт
	БылаИнициализация=1;

	ИмяТаблицы="rights";

	ТаблицаБД=СоздатьОбъект("ТаблицаБД");
	ТаблицаБД.УстановитьИмяИдентификатора("ИД"); 
	ТаблицаБД.ДобавитьПоле("ИД","Число",20,0);
	ТаблицаБД.ДобавитьПоле("НаборПрав","Число",20,0);
	ТаблицаБД.ДобавитьПоле("ТипПрава","Строка",30,0);
	ТаблицаБД.ДобавитьПоле("Форма","Строка",200,0);
	ТаблицаБД.ДобавитьПоле("ОбъектМетаданных","Число",20,0);	
	ТаблицаБД.НачальнаяИнициализация("ПраваДоступа",ИмяТаблицы,2,0);
	
КонецПроцедуры

//******************************************************************************************
//Предопределенные процедуры и функции в режиме Конфигуратора
//******************************************************************************************
Процедура ПриНачалеРаботыКонфигуратора()

КонецПроцедуры 


Процедура ПриЗавершенииРаботыКонфигуратора()

КонецПроцедуры 

