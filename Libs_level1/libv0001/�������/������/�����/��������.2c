///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Процедура ПриОткрытии()
	Перем МасДлинКолонок;
	Мас=Форма.Параметр;
	Если ТипЗначения(Мас)<>5 Тогда
		 Ошибка("В качестве параметра ожидается 2-х мерный массив");
		 Возврат;
	КонецЕсли
	
	Если РазмерМассива(Мас)=0 Тогда
		 Возврат;
	КонецЕсли
	

	ТаблицаРезультата.ЗадатьТекст(0,0,"№");
	ТаблицаРезультата.УстановитьШиринуКолонки(0,40);
	ТаблицаРезультата.КоличествоКолонок(РазмерСтруктуры(Мас[1])+1);

	//возвращаемые поля
	Состояние("Заполнение таблицы");
	Для А=1 По РазмерСтруктуры(Мас[1]) Цикл
		Имя=Мас[1].ИдентификаторПоНомеру(А);
		МасДлинКолонок[А]=СтрДлина(Имя);
		ТаблицаРезультата.ЗадатьТекст(0,А,Имя);
	КонецЦикла

	Для Ном=1 По РазмерМассива(Мас) Цикл
		ТаблицаРезультата.КоличествоСтрок(Ном+1);
		ТаблицаРезультата.ЗадатьТекст(Ном,0,Ном);
		Для А=1 По РазмерСтруктуры(Мас[Ном]) Цикл
			Имя=Мас[Ном].ИдентификаторПоНомеру(А);
			Значение=Мас[Ном][Имя];
			МасДлинКолонок[А]=Макс(МасДлинКолонок[А],СтрДлина(Сокрп(Значение)));
			ТаблицаРезультата.ЗадатьТекст(Ном,А,Значение);
		КонецЦикла
	КонецЦикла

	Для А=1 По РазмерСтруктуры(Мас[1]) Цикл
		ТаблицаРезультата.УстановитьШиринуКолонки(А,Макс(4,МасДлинКолонок[А])*10);
	КонецЦикла
	ТаблицаРезультата.Обновить();
	Состояние("");
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()

КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Выполнить
Процедура Выполнить()

КонецПроцедуры
