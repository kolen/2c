Перем ЗапросВыборка;
Перем Имя Экспорт; 
Перем Значение Экспорт;
/////////////////////////////////////////////////////////////////////////////////////////////
//Предопределенные процедуры и функции объекта
/////////////////////////////////////////////////////////////////////////////////////////////

//___________________________________________________________________________________________
Функция ПолучитьАтрибут(Имя) Экспорт
	ПроверитьИмя(Имя);
	ЗапросБД.Запрос("SELECT VALUE FROM "+ИмяТаблицы+" WHERE NAME='"+Имя+"'");
	Стр="";
	Если ЗапросБД.ПолучитьСтроку()=1 Тогда
		Стр=ЗапросБД.ПолучитьПоле(1);
	КонецЕсли;
	Возврат СоответствияПолей.ЗначениеИзСтр(Имя,Стр);
КонецФункции

//___________________________________________________________________________________________
Процедура УстановитьАтрибут(Имя,Значение) Экспорт
	ПроверитьИмя(Имя);
	
	СтрДанных=СоответствияПолей.СтрИзЗначения(Имя,Значение);
	Если ВРег(СоответствияПолей.ПолучитьТипПоля(Имя))<>"СТРОКА" Тогда
		СтрДанных="'"+СтрДанных+"'";
	КонецЕсли
	Если ЗапросБД.ТипСоединения()=ConnectionDBF Тогда
		ЗапросБД.Запрос("DELETE FROM "+ИмяТаблицы+" WHERE NAME='"+Имя+"'");
		ЗапросБД.Запрос("INSERT INTO "+ИмяТаблицы+"(NAME,VALUE) VALUES ('"+Имя+"',"+СтрДанных+")");
	Иначе
		ЗапросБД.Запрос("REPLACE INTO "+ИмяТаблицы+"(NAME,VALUE) VALUES ('"+Имя+"',"+СтрДанных+")");
	КонецЕсли
КонецПроцедуры



//___________________________________________________________________________________________
Функция ПроверитьИмя(Имя)
	Номер=МассивРеквизитов[Врег(Сокрлп(Имя))];
	Если Номер<>1 Тогда
		Ошибка("Атрибут "+Имя+" не найден");
	КонецЕсли;
	Возврат 1;
КонецФункции

//___________________________________________________________________________________________
Функция Количество() Экспорт
	Возврат Разм(МассивИмен);
КонецФункции

Функция Наименование(Ном) Экспорт
	Если Ном>0 И Ном<=Разм(МассивИмен) Тогда
		Возврат МассивИмен[Ном];
	КонецЕсли;
	Ошибка("Номер ("+Ном+") выходит за границы допустимых значений (1-"+Разм(МассивИмен)+")");
КонецФункции

//___________________________________________________________________________________________

//Выборка констант
Функция ВыбратьКонстанты() Экспорт
	ЗапросВыборка=СоздатьОбъект("БазаДанных");
	Возврат ЗапросВыборка.Запрос("SELECT NAME,VALUE FROM "+ИмяТаблицы);
КонецФункции

//___________________________________________________________________________________________
//Получение следующего элемента из выборки
Функция ПолучитьКонстанту() Экспорт
	Если ЗапросВыборка.ПолучитьСтроку()=1 Тогда
		Имя=ЗапросВыборка.ПолучитьПоле(1);
		Значение=ЗапросВыборка.ПолучитьПоле(2);
		Возврат 1;
	КонецЕсли;
	Возврат 0;
КонецФункции


Функция ОткрытьФормуСписка() Экспорт
	ОткрытьФорму("СписокКонстант");
КонецФункции

//___________________________________________________________________________________________
Процедура Конструктор()
	Если БылаИнициализация<>1 Тогда
		 НачальнаяИнициализация();
	КонецЕсли
КонецПроцедуры//Конструктор
