Перем ТипОбъектов;
Перем ТекНадпись;

//___________________________________________________________________________________________
Функция ПолучитьАтрибут(Имя)Экспорт
	Попытка
		Возврат ТабличнаяЧасть.ПолучитьАтрибут(Имя);
	Исключение
		Ошибка(ОписаниеОшибки());
	КонецПопытки
	
КонецФункции//ПолучитьАтрибут

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Процедура ПриОткрытии()
	ТекНадпись=Форма.ПолучитьСвойствоМикроформы("Заголовок");
	//Форма.ДобавитьСвойствоМикроформы("Заголовок");
	//Форма.УстановитьСвойствоМикроформы("123",123);
	//Сообщить("1 ТекНадпись="+ТекНадпись);

	ТипОбъектов=Форма.ПолучитьСвойствоМикроформы("Тип объектов списка");
	Форма.ДобавитьСвойствоМикроформы("Тип объектов списка","","ТипЗначения");
	//Число
	//Строка
	//Цвет
	//Событие
	//ТипЗначения
	//Переменная

	Если РежимРаботы()="Предприятие" Тогда
		Если ПустоеЗначение(ТипОбъектов)=0 Тогда
			ТабличнаяЧасть.Инициализация(ТипОбъектов);
		КонецЕсли
	КонецЕсли
	
	Если ПустоеЗначение(ТекНадпись)=1 Тогда
		ТекНадпись="Список объектов: "+ТипОбъектов;
	КонецЕсли
	Надпись.Заголовок(ТекНадпись);
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()
//	Если СостояниеКлавиши(27) Тогда
//		СтатусВозврата(0);
//	КонецЕсли;
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при повторном открытии формы
Процедура ПриПовторномОткрытии()
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при начале выбора значения
Процедура ПриНачалеВыбораЗначения(Идентификатор,ФлагСтандартнойОбработки)
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при окончании выбора значения
Процедура ОбработкаВыбораЗначения(Значение,Идентификатор,ФлагСтандартнойОбработки)
КонецПроцедуры


///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Выполнить
Процедура Выполнить()

КонецПроцедуры

//___________________________________________________________________________________________
Функция Заголовок(Стр="")Экспорт
	ПредЗначение=ТекНадпись;
	Если ПустоеЗначение(Стр)=0 Тогда
		ТекНадпись=Стр;
		Надпись.Заголовок(ТекНадпись);
	КонецЕсли
	
	Возврат ПредЗначение;
КонецФункции//Заголовок



//___________________________________________________________________________________________
Функция ТипОбъектов(Стр="")Экспорт
	ПредЗначение=ТипОбъектов;
	Если ПустоеЗначение(Стр)=0 Тогда
		ТипОбъектов=Стр;
		ТабличнаяЧасть.Инициализация(ТипОбъектов);
	КонецЕсли
	Возврат ПредЗначение;
КонецФункции//Заголовок


//___________________________________________________________________________________________
Функция Вид()
	Попытка
	Возврат ТабличнаяЧасть.ТекущийЭлемент.Вид();
	Исключение
	Возврат "";
	КонецПопытки;
КонецФункции//Вид

//___________________________________________________________________________________________
Функция Время()
	Попытка
	Возврат ТабличнаяЧасть.ТекущийЭлемент.ПолучитьВремяДокумента();
	Исключение
	Возврат "<>";
	КонецПопытки;
КонецФункции//Время
