Перем Ч,М,С;
Перем глОбъектТорговля;
///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Процедура ПриОткрытии()
	//Форма.Заголовок("Тесты!");
	ФС=СоздатьОбъект("Файловая система");
	ИмяФайла=КаталогПрограммы()+"Enterprise.exe";
	РазмерФайла=0;
	Атрибуты=0;
	ВремяСоздания="";
	ВремяОткрытия="";
	ВремяИзменения="";
	РасшИмя="";
	ФС.АтрибутыФайла( ИмяФайла,РазмерФайла, Атрибуты,ВремяСоздания,ВремяОткрытия,ВремяИзменения,РасшИмя); 
	Сообщить(РазмерФайла);
	Сообщить(ВремяИзменения);
	Сообщить(ВремяОткрытия);
	Сообщить(ВремяСоздания);
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Выполнить
Процедура Выполнить()
	
КонецПроцедуры

//******************************************************************************
//******************************************************************************
//******************************************************************************
//******************************************************************************
//******************************************************************************
//******************************************************************************
//******************************************************************************
Функция глПолуитьОбъектТорговля() Экспорт
	Если ТипЗначения(глОбъектТорговля)<>100 Тогда
		ПутькБазе=Сокрлп("C:\1C\FoodLine\Lodoch");
		Если ПутькБазе="" Тогда
			Сообщить("Не настроена константа ""Путь к базе торговли""!","!");
			Возврат 0;
		КонецЕсли;
		глОбъектТорговля=СоздатьОбъект("V77.Application");
		Если глОбъектТорговля.Initialize(глОбъектТорговля.RMTrade,"/d"+ПутькБазе+" /NРобот","")=0 Тогда//NO_SPLASH_SHOW
			глОбъектТорговля=0;
			Предупреждение("Ошибка открытия базы "+ПутькБазе+" (Возможно не заведен пользователь с именем Робот)");
			Возврат 0;
		КонецЕсли;
	КонецЕсли;
	Возврат глОбъектТорговля;
КонецФункции // глПолуитьОбъектТорговля()

Процедура ТестОЛЕ()
	Торговля=глПолуитьОбъектТорговля();
	Сообщить("Торговля ("+ТипЗначения(Торговля)+") = "+Торговля);
	Если Торговля<>0 Тогда
		Рег=Торговля.CreateObject("Регистр.ОстаткиТоваров");
		Табл0=Торговля.CreateObject("ТаблицаЗначений");;
		Рег.ВыгрузитьИтоги(Табл0,1);
		Табл0.ВыбратьСтроку("","");
	КонецЕсли;
КонецПроцедуры



//******************************************************************************
//******************************************************************************
//******************************************************************************





Процедура СоздатьДокумент(Номер)
	Док=СоздатьОбъект("Документ.ПриходнаяНакладная");
	Док.Новый(); 
	Док.НомерДок="Рнк-"+Номер;
	Док.Автор="Иванов";
	Док.Клиент="ООО Лоза";
	Док.Записать();
КонецПроцедуры;


Процедура ТестСозданияДокументов()
	ТекущееВремя(Ч,М,С);
	Время1=Ч*3600+М*60+С;
	
	Для А=1 По 3000 Цикл//7-8 сек
		СоздатьДокумент(А);
	КонецЦикла;
	
	
	ТекущееВремя(Ч,М,С);
	Время2=Ч*3600+М*60+С;
	Сообщить("Прошло времени "+(Время2-Время1));
КонецПроцедуры;


Процедура ТестСозданияПрихНакладных()
	ОчиститьОкноСообщений();
	Док=СоздатьОбъект("Документ.ПриходнаяНакладная");
	Док.Новый(); 
	Док.НомерДок="Рнк-11";
	Док.Автор="Иванов";
	Док.Клиент="ООО Лоза";
	Док.Записать();
	
	Стр=ЗначениеВСтроку(Док);
	
	Док.Новый(); 
	Док.НомерДок="Рнк-15";
	Док.Автор="Петров";
	Док.Клиент="ООО ПиБи";
	Док.Записать();
	Док.Провести();
	
	Док2=Док.ТекущийДокумент();
	
	
	Сообщить(Стр);
	Док1=ЗначениеИзСтроки(Стр);
	
	Сообщить("Док1="+Док1);
	Док1.НомерДок="00123";
	Док1.Записать();
	Сообщить("Док1="+Док1);
	
	Сообщить("Док2="+Док2);
КонецПроцедуры;

Процедура СписокКонстант()
	СоздатьОбъект("Константа").ОткрытьФормуСписка();
КонецПроцедуры;

Процедура ТестТабл ()
	ОткрытьФорму("ФормаТабл");
КонецПроцедуры;

Процедура ВиртуальныйРежимТаблицы()
	ОткрытьФорму("ВиртуальныйРежимТаблицы");
КонецПроцедуры;




Процедура ЦиклПока()
	Число Б,С;
	
	Время1=_GetPerformanceCounter();
	Б=0;
	С=1;
	Для А=1 По 100000 Цикл
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
		 Б=Б+С;
	КонецЦикла
	
	
	Время2=_GetPerformanceCounter();
	Сообщить("Прошло времени "+(Время2-Время1)+" мс");
КонецПроцедуры // ЦиклПока()
