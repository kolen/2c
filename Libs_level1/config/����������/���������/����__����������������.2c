Перем НеЗакрывать;
///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Процедура ПриОткрытии()

КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()
	Если НеЗакрывать=1 Тогда
		 СтатусВозврата(0);
		 Ошибка("Дождитесь завершения работы программы");
	КонецЕсли
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Выполнить
Процедура Выполнить()
	Если НеЗакрывать=1 Тогда
		 Сообщить("Программа уже запущена!!");
		 Возврат;
	КонецЕсли
	
	НеЗакрывать=1;
	Попытка
	Для А=1 По 300 Цикл
		 Индикатор=А;
		 Пауза(10);
		 ОбработатьСообщения();
	КонецЦикла
	Исключение
	Сообщить("Программа прервана пользователем");
	КонецПопытки
	НеЗакрывать=0;
КонецПроцедуры
