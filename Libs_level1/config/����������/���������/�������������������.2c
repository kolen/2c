//---------------------------------------------------------
//Набор тестов для объекта ТаблицаЗначений
//---------------------------------------------------------
//Автор:  Alex_Bob 
//E-mail: asbobylk@svsokol.lipetsk.ru
//Версия модуля: 1.22 от 09.03.2004
//Релиз платформы: 05.03.2004
//
//Проверяемые методы:
//---------------------------------------------------------
//КоличествоКолонок()+
//НоваяКолонка()+
//ВставитьКолонку()+
//УдалитьКолонку()+
//УстановитьПараметрыКолонки()+
//ПолучитьПараметрыКолонки()+
//КоличествоСтрок()+
//НоваяСтрока()+
//УдалитьСтроку()+
//УдалитьСтроки()+
//ВыбратьСтроки()+
//ПолучитьСтроку()+
//ПолучитьСтрокуПоНомеру()+
//СдвинутьСтроку()+
//НайтиЗначение()+
//Сортировать()+
//Очистить()+
//Итог()+
//Заполнить()+
//УстановитьЗначение()+
//ПолучитьЗначение()+
//ТекущаяСтрока()+
//ТекущаяКолонка()+
//Свернуть()+
//Выгрузить()+
//Загрузить()+
//ВидимостьКолонки()+
//Фиксировать()+
//ВыводитьПиктограммы()+ 
//---------------------------------------------------------
Перем ТЗ1;
Перем Сп;
///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Процедура ПриОткрытии()
    ТЗ.НоваяКолонка("Строка","Строка");
	ТЗ.НоваяКолонка("Число","Число");
	Форма.Тест2.Доступность(0);
	Форма.Тест3.Доступность(0);
	Форма.Тест4.Доступность(0);
	Форма.Тест6.Доступность(0);
	Форма.Тест7.Доступность(0);
	Форма.Тест8.Доступность(0);
	Форма.Пиктограммы.Доступность(0);
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()

КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Выполнить
Процедура Выполнить()
//ТЗ=СоздатьОбъект("ТаблицаЗначений",ТЗ1);
    ТЗ.Очистить();
    ТЗ.НоваяКолонка("Строка","Строка");
	ТЗ.НоваяКолонка("Число","Число");	
	ТЗ.НоваяКолонка("Дата","Дата");
	ТЗ.НоваяКолонка("Пустой",)
	ТЗ.НоваяКолонка("Неопределенный","Неопределенный");
	ТЗ.НоваяКолонка("СписокЗначений","СписокЗначений");
	ТЗ.НоваяСтрока();
	Сообщить(ТЗ.Строка+"("+ТипЗначенияСтр(ТЗ.Строка)+")");
	Сообщить(ТЗ.Число+"("+ТипЗначенияСтр(ТЗ.Число)+")");
	Сообщить(ТЗ.Дата+"("+ТипЗначенияСтр(ТЗ.Дата)+")");
	Сообщить(ТЗ.Пустой+"("+ТипЗначенияСтр(ТЗ.Пустой)+")");
	Сообщить(ТЗ.Неопределенный+"("+ТипЗначенияСтр(ТЗ.Неопределенный)+")");
	Сообщить(ТЗ.СписокЗначений+"("+ТипЗначенияСтр(ТЗ.СписокЗначений)+")");
	
	ТЗ.Строка="Это строка";
	ТЗ.Число=123456789;
	ТЗ.Дата='01.12.2003';
	ТЗ.Пустой=СоздатьОбъект("Массив");
	ТЗ.Пустой[1]=123;
	ТЗ.СписокЗначений=СоздатьОбъект("СписокЗначений");
	ТЗ.СписокЗначений.ДобавитьЗначение(1);
	ТЗ.СписокЗначений.ДобавитьЗначение(2);
	Сообщить("После присвоения значений:");
	Сообщить(ТЗ.Строка+"("+ТипЗначенияСтр(ТЗ.Строка)+")");
	Сообщить(ТЗ.Число+"("+ТипЗначенияСтр(ТЗ.Число)+")");
	Сообщить(ТЗ.Дата+"("+ТипЗначенияСтр(ТЗ.Дата)+")");
	Сообщить(ТЗ.Пустой+"("+ТипЗначенияСтр(ТЗ.Пустой)+")");
	Сообщить(ТЗ.Неопределенный+"("+ТипЗначенияСтр(ТЗ.Неопределенный)+")");
	Сообщить(ТЗ.СписокЗначений+"("+ТипЗначенияСтр(ТЗ.СписокЗначений)+")");
	ТЗ.УдалитьСтроки();
	Сообщить("ТЗ.УдалитьСтроки()   КС="+ТЗ.КоличествоСтрок()+"  КК="+ТЗ.КоличествоКолонок());
	ТЗ.Очистить();
	Сообщить("ТЗ.Очистить()   КС="+ТЗ.КоличествоСтрок()+"  КК="+ТЗ.КоличествоКолонок());
	ТЗ.ВставитьКолонку("Строка","Строка");
	ТЗ.НоваяКолонка("Число","Число");
	Для А=1 По 10 Цикл
		ТЗ.НоваяСтрока();
	    ТЗ.Строка="Строка "+Строка(А);
	    ТЗ.Число=А;
	    Сообщить(Строка(ТЗ.НомерСтроки)+"  "+Строка(ТЗ.Число));
	КонецЦикла
	ТЗ.УдалитьСтроку(5);
	ТЗ.ВыбратьСтроки();
	Пока ТЗ.ПолучитьСтроку()=1 Цикл
	    Сообщить(Строка(ТЗ.НомерСтроки)+"  "+Строка(ТЗ.Число));
	КонецЦикла
	ТЗ.СдвинутьСтроку(-3,5);
    Сообщить("Удалили строку 5 и сдвинули на 3 вперед");
	ТЗ.ВыбратьСтроки();
	Пока ТЗ.ПолучитьСтроку()=1 Цикл
	    Сообщить(Строка(ТЗ.НомерСтроки)+"  "+Строка(ТЗ.Число));
	КонецЦикла
    ТЗ.Сортировать("Число");
    Сообщить("Сортировка");
    ТЗ.ВыбратьСтроки();
	Пока ТЗ.ПолучитьСтроку()=1 Цикл
	    Сообщить(Строка(ТЗ.НомерСтроки)+"  "+Строка(ТЗ.Число));
	КонецЦикла
    
	Сообщить("ТЗ.Итог="+ТЗ.Итог("Число"));
	Форма.Тест4.Доступность(0);
	Форма.Пиктограммы.Доступность(1);
КонецПроцедуры
///////////////////////////////////////////////////////////////////////
Процедура Создать50000()
    ТЗ.Очистить();
	ТЗ.ВставитьКолонку("Строка","Строка");
	ТЗ.НоваяКолонка("Число","Число");
	ТЗ.НоваяКолонка("Единица","Число");
	ТЗ.УдалитьКолонку("Единица","Число");
	ТЗ.НоваяКолонка("Единица_","Число");
	Сообщить("Тест производительности");
	Сообщить(ТекущееВремя());
	Для А=1 По 500 Цикл
		Для Б=1 По 100 Цикл
			ТЗ.НоваяСтрока();
	        ТЗ.Строка="Строка "+Строка(Б);
	        ТЗ.Число=А;
	        ТЗ.Единица_=1;
	    КонецЦикла;
	КонецЦикла;                          
	Сообщить(ТекущееВремя());
	Форма.Тест2.Доступность(1);
	Форма.Тест1.Доступность(0);
КонецПроцедуры
///////////////////////////////////////////////////////////////////////
Процедура Свернуть()
	Сообщить(ТекущееВремя());	
	ТЗ.Свернуть("Строка","Число");
	Сообщить(ТекущееВремя());
	Сообщить(ТЗ.КоличествоСтрок());
	Форма.Тест2.Доступность(0);
	Форма.Тест3.Доступность(1);
КонецПроцедуры
///////////////////////////////////////////////////////////////////////
Процедура ВклВыклПиктограммы()
	ТЗ.ВыводитьПиктограммы("Число");
 	Форма.Пиктограммы.Доступность(0);
 	Форма.Тест6.Доступность(1);
КонецПроцедуры
///////////////////////////////////////////////////////////////////////
//Обработка события объекта Тест2
Процедура НажатиеТест2()
   ТЗ.Очистить();
	ТЗ.ВставитьКолонку("Товар","Справочник.Товар");
	ТЗ.НоваяКолонка("Число","Число");
	ТЗ.НоваяКолонка("Единица","Число");
	ТЗ.НоваяСтрока();
    ТЗ.Товар=ВыбСтатья;
    ТЗ.Число=123;
    ТЗ.Единица=1;

КонецПроцедуры
///////////////////////////////////////////////////////////////////////
//Выгрузка в другую ТЗ
Процедура Выгрузка()
    ТЗ1=СоздатьОбъект("ТаблицаЗначений");
    Сп=СоздатьОбъект("СписокЗначений");
    Сообщить(Строка(ТекущееВремя())+"-выгрузка в таблицу значений");
    ТЗ.Выгрузить(ТЗ1);
    Сообщить(Строка(ТекущееВремя())+"-ОК.ТЗ1.КоличествоСтрок()="+Строка(ТЗ1.КоличествоСтрок()));
    Сообщить(Строка(ТекущееВремя())+"-выгрузка в список значений");
    ТЗ.Выгрузить(Сп);
    Сообщить(Строка(ТекущееВремя())+"-ОК.Сп.РазмерСписка()="+Строка(Сп.РазмерСписка()));
    Сообщить(Строка(ТекущееВремя())+"-выгрузка в создаваемую таблицу значений");
    ТЗ2=0;
    ТЗ.Выгрузить(ТЗ2);    
    Сообщить(Строка(ТекущееВремя())+"-ОК.ТЗ2.КоличествоСтрок()="+Строка(ТЗ1.КоличествоСтрок()));
    Форма.Тест3.Доступность(0);
    Форма.Тест4.Доступность(1);
КонецПроцедуры
///////////////////////////////////////////////////////////////////////
//Загрузка из ТЗ
Процедура Загрузка()
    Сообщить(Строка(ТекущееВремя())+"-загрузка из таблицы значений");
    ТЗ.Загрузить(ТЗ1);
    Сообщить(Строка(ТекущееВремя())+"-ОК.ТЗ.КоличествоСтрок()="+Строка(ТЗ.КоличествоСтрок()));
    Если ТЗ.ПолучитьСтрокуПоНомеру(100)=1 Тогда
        ТЗ.ТекущаяСтрока(ТЗ.КоличествоСтрок());    
    ТЗ.ТекущаяКолонка(ТЗ.КоличествоКолонок());  
  	 
    КонецЕсли;
    Форма.Тест6.Доступность(0);
    Форма.Тест7.Доступность(1);

КонецПроцедуры
///////////////////////////////////////////////////////////////////////
//Параметры колонки
Процедура ПараметрыКолонки()
    Сообщить("Получить параметры колонки ""Число"":");
    Тип="";
    Длина=0;
    Точность=0;
    Заголовок="";
    Ширина=0;
    НомКол=ТЗ.ПолучитьПараметрыКолонки("Число",Тип,Длина,Точность,Заголовок,Ширина);
    Сообщить("Номер колонки - "+Строка(НомКол));
    Сообщить("Тип - "+Тип);
    Сообщить("Длина - "+Строка(Длина));
    Сообщить("Точность - "+Строка(Точность));
    Сообщить("Заголовок - "+Заголовок);
    Сообщить("Ширина - "+Ширина);
    Сообщить("УстановитьПараметрыКолонки()");
    ТЗ.УстановитьПараметрыКолонки("Число","Число",15,2,"Число с двумя знаками",30);
    НомКол=ТЗ.ПолучитьПараметрыКолонки("Число",Тип,Длина,Точность,Заголовок,Ширина);
    Сообщить("Номер колонки - "+Строка(НомКол));
    Сообщить("Тип - "+Тип);
    Сообщить("Длина - "+Строка(Длина));
    Сообщить("Точность - "+Строка(Точность));
    Сообщить("Заголовок - "+Заголовок);
    Сообщить("Ширина - "+Ширина);
    ТЗ.НоваяКолонка("Новая");
    ТЗ.Фиксировать(3,1);
    ТЗ.Заполнить(123,5,10,"Число");
    ТЗ.ВставитьКолонку("Дата_",2,"Дата",,,"Это дата",15,"Д(0)ДДММГГГГ",0);
    ТЗ.Заполнить(Дата("13.12.2003"),,,"Дата_");
    ТЗ.ВидимостьКолонки("Новая",0);
	Сообщить("ТЗ.НайтиЗначение(""Строка 100"")="+ТЗ.НайтиЗначение("Строка 100"));    
    Форма.Тест7.Доступность(0);
    Форма.Тест8.Доступность(1);
КонецПроцедуры