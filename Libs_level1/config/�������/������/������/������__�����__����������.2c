//******************************************************************************************
//  .--------------.
//  |База данных   >-
//  ·--------------·|
//                  |
//                  |
//  .---------------v---------.
//  |Запрос объекта Операции  |
//  ·-------------------------·
//******************************************************************************************
Перем БД;
Перем КонтекстРазбораВыражений;
Перем ТекстЗапроса;
Перем СтруктураЗапроса;
Перем МассивРезультата;


Перем ТекНомерВыборки;
//___________________________________________________________________________________________
//Динамическое получение атрибутов
Функция ПолучитьАтрибут(Имя) Экспорт
	Если ТекНомерВыборки>РазмерМассива(МассивРезультата) Тогда
		Ошибка("Не было выборки строк");
	КонецЕсли
	Возврат МассивРезультата[ТекНомерВыборки][Имя];
КонецФункции

//___________________________________________________________________________________________
//Динамическое задание атрибутов
Процедура УстановитьАтрибут(Имя,Значение) Экспорт
	
КонецПроцедуры

//___________________________________________________________________________________________
Функция ПолучитьИмяАтрибута(Номер)Экспорт

КонецФункции
//___________________________________________________________________________________________
Функция ПолучитьКоличествоАтрибутов()Экспорт

КонецФункции

//___________________________________________________________________________________________
Функция Выполнить(Текст) Экспорт

	КонтекстРазбораВыражений=ПолучитьКонтекстВызова();
	ТекстЗапроса=Текст;	
	СтруктураЗапроса=Парсинг(ТекстЗапроса,КонтекстРазбораВыражений);
	ТаблицаРезультата=ВыполнитьЗапрос(СтруктураЗапроса);
	МассивРезультата=ОбработатьЗапрос(СтруктураЗапроса,ТаблицаРезультата);
КонецФункции

//___________________________________________________________________________________________
Процедура Просмотр() Экспорт
	 ОткрытьФорму("Просмотр",МассивРезультата);
КонецПроцедуры

//___________________________________________________________________________________________
Функция ВыбратьСтроки() Экспорт
	ТекНомерВыборки=0;
	Возврат РазмерМассива(МассивРезультата)<>0;
КонецФункции//ВыбратьСтроки

//___________________________________________________________________________________________
Функция ПолучитьСтроку() Экспорт
	ТекНомерВыборки=ТекНомерВыборки+1;
	Если ТекНомерВыборки>РазмерМассива(МассивРезультата) Тогда
		Возврат 0;
	КонецЕсли
	Возврат 1;
КонецФункции//ПолучитьСтроку

////___________________________________________________________________________________________
//Функция ПолучитьЗначения() Экспорт
//	Если ТекНомерВыборки>РазмерМассива(МассивРезультата) Тогда
//		Ошибка("Не было выборки строк");
//	КонецЕсли
//	Возврат МассивРезультата[ТекНомерВыборки];
//КонецФункции//ПолучитьЗначения
