Перем Константа2;
///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при первом открытии формы
Процедура ПриОткрытии()
	Константа2=СоздатьОбъект("Константа"); 
	Таблица.КоличествоСтрок(Константа2.Количество()+1);
	
	Если Константа2.Количество()>0 Тогда
		Мета=СоздатьОбъект("Метаданные").Массив.Метаданные["Константа"];
		Для Б=1 По Константа2.Количество() Цикл
			Наименование=Константа2.Наименование(Б);
			Синоним=Мета[Наименование].Синоним;
			Если ПустоеЗначение(Синоним)=1 Тогда
				Синоним=Наименование;
			КонецЕсли;
			Комментарий=Мета[Наименование].Комментарий;
			Если ПустоеЗначение(Комментарий)=1 Тогда
				Комментарий=Синоним;
			КонецЕсли;
			
			Таблица.Текст(Б,0,Наименование);
			Таблица.Текст(Б,1,Комментарий);
			Значение=Константа2.ПолучитьАтрибут(Константа2.Наименование(Б));
			Таблица.Значение(Б,2,Значение);
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Предопределенная процедура - вызывается при закрытии формы
Процедура ПриЗакрытии()
	Если СостояниеКлавиши(27) Тогда
		СтатусВозврата(0);
	КонецЕсли;
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Закрыть - выполняет закрытие формы
Процедура ЗакрытьФорму()
	Форма.Закрыть();
КонецПроцедуры

///////////////////////////////////////////////////////////////////////
//Процедура обработки нажатия кнопки Выполнить
Процедура Выполнить()

КонецПроцедуры


Процедура НачалоРедактирования()
	Кол=Таблица.ТекущаяКолонка();
	Стр=Таблица.ТекущаяСтрока();
	Таблица.ПолучитьСтрокуПоНомеру(Стр);//для доступа к значениям таблицы через атрибуты
	Если Кол<>2 Тогда
		СтатусВозврата(0);
		Возврат;
	КонецЕсли
	Если СокрЛП(Таблица.Код)="" Тогда
		СтатусВозврата(0);
		Возврат;
	КонецЕсли
КонецПроцедуры

 
Процедура ОкончаниеРедактирования()
	 Кол=Таблица.ТекущаяКолонка();
	 Стр=Таблица.ТекущаяСтрока();
	 Таблица.ПолучитьСтрокуПоНомеру(Стр);//для доступа к значениям таблицы через атрибуты
	 Если Кол=2 Тогда
		 Если СокрЛП(Таблица.Код)<>"" Тогда
			 Константа2.УстановитьАтрибут(Таблица.Код,Таблица.Значение);
		 КонецЕсли
	 КонецЕсли
КонецПроцедуры
 
 
 